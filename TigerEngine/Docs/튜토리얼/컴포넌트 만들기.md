## 컴포넌트 추가하기

컴포넌트는 두 가지로 분류됩니다.

렌더링하는 컴포넌트와 일반 컴포넌트

헤더 : `#include "Entity/Component.h"` , `#include "Entity/RenderComponent.h"`

### 렌더링 컴포넌트 만들기

렌더링 컴포넌트는 `RenderComponent` 를 상속받아서 사용합니다.

```jsx
#include "Entity/Component.h"

class MeshRenderer : public RenderComponent
{
private:

public:
	void OnInitialize() override;
	void OnStart() override;
	void OnUpdate(float delta) override;
};
```

렌더링 컴포넌트는 

```jsx
class RenderComponent : public Component
{
public:
    std::weak_ptr<IRenderCommand> GetCommand() { return command; }
    void SetCommand(std::shared_ptr<IRenderCommand> rc) { command = rc; }
protected:
    std::shared_ptr<IRenderCommand> command;
};
```

위와 같이 구성되어 있는데 생성한 컴포넌트에서 SetCommnad를 사용해 렌더링할 데이터를 넘겨줘야합니다.

### 예시 : FBXRenderer::CreateCommand()

```cpp
void FBXRenderer::CreateCommand()
{	
	auto command = std::make_shared<DrawFBXCommand>();
	command->CreateCommand(fbxData->GetFBXInfo(), bonePoses, owner->GetTransform());
	command->SetColor(color);
	command->SetMetalic(metalic);
	command->SetRoughness(roughness);

	SetCommand(command); //
}
```

### 일반 Component 만들기

일반 컴포넌트는 `Component` 객체를 상속받아서 만듭니다.

FbxData.h

```cpp
class FBXData : public Component
{
    RTTR_ENABLE(Component)
public:
    void OnInitialize() override;
    const std::vector<Mesh>& GetMesh() const;
    const std::shared_ptr<FBXResourceAsset> GetFBXInfo() const;

    void ChangeData(std::string path);

    nlohmann::json Serialize() override;
	void Deserialize(nlohmann::json data) override;
    
    std::string path = ""; // fbx path data

protected:
    std::vector<Mesh> meshes; // 현재 컴포넌트가 들고 있는 mesh 정보
    std::shared_ptr<FBXResourceAsset> fbxAsset; // 현재 컴포넌트가 들고 있는 mesh 정보
};
```

컴포넌트 안에는 OnInitialize, OnStart, OnUpdate가 있습니다.

OnInitialize는 오브젝트에 컴포넌트를 부착했을 때 바로 실행됩니다 ( AddComponent )

OnStart는 Update 시작 전에 한 번 호출됩니다.

OnUpdate는 매 프레임마다 호출됩니다.

## 컴포넌트 등록하기

Imgui로 컴포넌트를 추가하려면 Factory에 추가해야합니다.

`Base/App/EngineApp.cpp` 에서 정의한 컴포넌트를 수동으로 추가합니다.

EngineApp.cpp

```cpp
// ================= 컴포넌트 등록 =================

#include "../Components/FBXData.h"
#include "../Components/FBXRenderer.h"
#include "Entity/Transform.h"
#include "Entity/Camera.h"
#include "System/ComponentFactory.h"

void EngineApp::RegisterAllComponents()
{
	ComponentFactory::Instance().Register<FBXData>("FBXData");
	ComponentFactory::Instance().Register<FBXRenderer>("FBXRenderer");
	ComponentFactory::Instance().Register<Transform>("Transform");
	ComponentFactory::Instance().Register<Transform>("Camera");
}
```